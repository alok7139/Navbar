 public void validateFatcaEntityCategory(CorporateCustomerTARWrapper corporateCustomerTARWrapper,List<ErrorObject> errorObjList)
     {
         LogWriter logWriter = LogWriter.getInstance("validateFatcaEntityCategory", "validateFatcaEntityCategory");
         FATCAEntCategoryEntityWrapper FATCAEntCategoryEntityWrapper;
         EntityCategoryWrapper entityCategoryWrapper=null;
 
         try
         {
             if(corporateCustomerTARWrapper.getEntityCategory()!=null)
             {
                 FATCAEntCategoryEntityWrapper=customerReferencesServiceHostBean.getEntityCategoryWrapperByKey(corporateCustomerTARWrapper.getEntityCategory());
                 entityCategoryWrapper=(EntityCategoryWrapper) new FATCAEntCategoryWithEntityTranslator().translateDomainToResource(FATCAEntCategoryEntityWrapper);
 
                 if(entityCategoryWrapper !=null)
                 {
                     if(entityCategoryWrapper.getCategoryType() != 'F')
                     {
                         errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                                 CustomerError.INVALID_FCATEGORY.getErrorCode(),
                                 CustomerError.INVALID_FCATEGORY.getErrorDescription(), "fatca-entity-cat"));
                     }
                     else
                     {
                         logWriter.println("Global"+corporateCustomerTARWrapper.getGloIntIdNo());
                         if((corporateCustomerTARWrapper.getGloIntIdNo()==null) && (entityCategoryWrapper.getGiinRequired()!='\u0000') && (entityCategoryWrapper.getGiinRequired()!='N'))
                         {
 
                             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                                     CustomerError.GLOBINT_MANDATORY_GIIN.getErrorCode(),
                                     CustomerError.GLOBINT_MANDATORY_GIIN.getErrorDescription(), "global-intermediary-identification-number"));
                         }
                     }
                 }
                 else
                 {
                     errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                             CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                             CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "fatca-entity-cat"));
                 }
             }
         }
         catch(FinderException e)
         {
 
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "fatca-entity-cat"));
         }
         catch(TechnicalComponentException e)
         {
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "fatca-entity-cat"));
         }
 
         catch(Exception e)
         {
 
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "fatca-entity-cat"));
         }
     }


import mockit.*;
import org.junit.*;
import java.util.*;

import static org.junit.Assert.*;

public class ValidateFatcaEntityCategoryTest {

    @Tested
    private YourServiceClass service; // Replace with your actual class name

    @Injectable
    private CustomerReferencesServiceHostBean customerReferencesServiceHostBean;

    @Injectable
    private FATCAEntCategoryEntityWrapper fatcaEntityWrapper;

    @Injectable
    private EntityCategoryWrapper entityCategoryWrapper;

    @Test
    public void test_CategoryTypeNotF_ShouldAddInvalidFCategoryError() throws Exception {

        CorporateCustomerTARWrapper corporateWrapper = new CorporateCustomerTARWrapper();
        corporateWrapper.setEntityCategory("TEST");

        List<ErrorObject> errorList = new ArrayList<>();

        new Expectations() {{
            customerReferencesServiceHostBean.getEntityCategoryWrapperByKey("TEST");
            result = fatcaEntityWrapper;

            new FATCAEntCategoryWithEntityTranslator().translateDomainToResource(fatcaEntityWrapper);
            result = entityCategoryWrapper;

            entityCategoryWrapper.getCategoryType();
            result = 'X';
        }};

        service.validateFatcaEntityCategory(corporateWrapper, errorList);

        assertFalse(errorList.isEmpty());
        assertEquals(CustomerError.INVALID_FCATEGORY.getErrorCode(),
                errorList.get(0).getErrorCode());
    }

    @Test
    public void test_GiinRequiredButGlobalIdNull_ShouldAddMandatoryError() throws Exception {

        CorporateCustomerTARWrapper corporateWrapper = new CorporateCustomerTARWrapper();
        corporateWrapper.setEntityCategory("TEST");
        corporateWrapper.setGloIntIdNo(null);

        List<ErrorObject> errorList = new ArrayList<>();

        new Expectations() {{
            customerReferencesServiceHostBean.getEntityCategoryWrapperByKey("TEST");
            result = fatcaEntityWrapper;

            new FATCAEntCategoryWithEntityTranslator().translateDomainToResource(fatcaEntityWrapper);
            result = entityCategoryWrapper;

            entityCategoryWrapper.getCategoryType();
            result = 'F';

            entityCategoryWrapper.getGiinRequired();
            result = 'Y';
        }};

        service.validateFatcaEntityCategory(corporateWrapper, errorList);

        assertFalse(errorList.isEmpty());
        assertEquals(CustomerError.GLOBINT_MANDATORY_GIIN.getErrorCode(),
                errorList.get(0).getErrorCode());
    }

    @Test
    public void test_EntityCategoryNull_ShouldNotAddError() {

        CorporateCustomerTARWrapper corporateWrapper = new CorporateCustomerTARWrapper();
        corporateWrapper.setEntityCategory(null);

        List<ErrorObject> errorList = new ArrayList<>();

        service.validateFatcaEntityCategory(corporateWrapper, errorList);

        assertTrue(errorList.isEmpty());
    }

    @Test
    public void test_FinderException_ShouldAddNotFoundError() throws Exception {

        CorporateCustomerTARWrapper corporateWrapper = new CorporateCustomerTARWrapper();
        corporateWrapper.setEntityCategory("TEST");

        List<ErrorObject> errorList = new ArrayList<>();

        new Expectations() {{
            customerReferencesServiceHostBean.getEntityCategoryWrapperByKey("TEST");
            result = new FinderException();
        }};

        service.validateFatcaEntityCategory(corporateWrapper, errorList);

        assertFalse(errorList.isEmpty());
        assertEquals(CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                errorList.get(0).getErrorCode());
    }
}


 
     public void validateCRSEntityCategory(CorporateCustomerTARWrapper corporateCustomerTARWrapper,List<ErrorObject> errorObjList)
     {
         LogWriter log = LogWriter.getInstance("CorporateCustomerValidator", "validateCRSEntityCategory");
         FATCAEntCategoryEntityWrapper FATCAEntCategoryEntityWrapper;
         EntityCategoryWrapper entityCategoryWrapper=null;
 
         try
         {
             if(corporateCustomerTARWrapper.getCrsEntityCategory()!=null)
             {
 
                 FATCAEntCategoryEntityWrapper=customerReferencesServiceHostBean.getEntityCategoryWrapperByKey(corporateCustomerTARWrapper.getCrsEntityCategory());
                 entityCategoryWrapper=(EntityCategoryWrapper) new FATCAEntCategoryWithEntityTranslator().translateDomainToResource(FATCAEntCategoryEntityWrapper);
                 log.println("After customerReferencesServiceHostBean check");
                 if(entityCategoryWrapper !=null)
                 {
                     if(entityCategoryWrapper.getCategoryType() != 'C')
                     {
                         errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                                 CustomerError.INVALID_CRS_CATEGORY.getErrorCode(),
                                 CustomerError.INVALID_CRS_CATEGORY.getErrorDescription(), "crs-entity-cat"));
 
                     }
                     else if (entityCategoryWrapper.getGiinRequired() == 'Y' && corporateCustomerTARWrapper.getGloIntIdNo()==null)
                     {
                         errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                                 CustomerError.GLOBINT_MANDATORY_GIIN.getErrorCode(),
                                 CustomerError.GLOBINT_MANDATORY_GIIN.getErrorDescription(), "global-intermediary-identification-number"));
 
                     }
                 }
                 else
                 {
                     errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                             CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                             CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "crs-entity-cat"));
                 }
             }
         }catch(FinderException e)
         {
 
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "crs-entity-cat"));
         }
 
         catch(TechnicalComponentException e)
         {
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "crs-entity-cat"));
         }
         catch(Exception e)
         {
             log.println("Inside NOT FOUNT***************CATEGORY");
             errorObjList.add(new ErrorObject(ExceptionType.SYSTEM.getValue(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorCode(),
                     CustomerError.FATCA_CATEGORY_NOT_FOUND.getErrorDescription(), "crs-entity-cat"));
         }
     }
